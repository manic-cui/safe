(safe) mannicui@hustvl-2030:~/SAFE$ bash scripts/eval.sh 
/data/mannicui/miniconda3/envs/safe/lib/python3.9/site-packages/torch/distributed/launch.py:183: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use-env is set by default in torchrun.
If your script expects `--local-rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
[2025-12-11 22:50:49,780] torch.distributed.run: [WARNING] 
[2025-12-11 22:50:49,780] torch.distributed.run: [WARNING] *****************************************
[2025-12-11 22:50:49,780] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2025-12-11 22:50:49,780] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://, gpu 0
| distributed init (rank 3): env://, gpu 3
| distributed init (rank 2): env://, gpu 2
| distributed init (rank 1): env://, gpu 1
Namespace(jpeg_factor=None, blur_sigma=None, mask_ratio=None, mask_patch_size=None, transform_mode='crop', batch_size=256, epochs=100, update_freq=1, model='SAFE', input_size=256, layer_decay_type='single', model_ema=False, model_ema_decay=0.9999, model_ema_force_cpu=False, model_ema_eval=False, clip_grad=None, weight_decay=0.05, lr=None, blr=0.0005, layer_decay=1.0, min_lr=1e-06, warmup_epochs=20, warmup_steps=-1, opt='adamw', opt_eps=1e-08, opt_betas=None, momentum=0.9, weight_decay_end=None, smoothing=0.1, mixup=0.0, cutmix=0.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', pretrained=True, global_pool=True, head_init_scale=0.001, model_key='model|module', model_prefix='', num_train=10000000000, data_path='', nb_classes=2, output_dir='/home/mannicui/SAFE/results/SAFE/20251211_220758', log_dir=None, device='cuda', seed=None, resume='/home/mannicui/SAFE/results/SAFE/20251211_220758/checkpoint-best.pth', eval_data_path='/data/mannicui/data/dataset/test_wildrf', imagenet_default_mean_and_std=True, data_set='IMNET', auto_resume=True, save_ckpt=True, save_ckpt_freq=5, save_ckpt_num=100, start_epoch=0, eval=True, dist_eval=True, disable_eval=False, num_workers=16, pin_mem=True, crop_pct=None, world_size=4, local_rank=0, dist_on_itp=False, dist_url='env://', use_amp=False, rank=0, gpu=0, distributed=True, dist_backend='nccl')
Number of params: 1.44M
Base lr: 5.00e-04
Actual lr: 2.00e-03
Accumulate grad iterations: 1
Effective batch size: 1024
criterion = LabelSmoothingCrossEntropy()
Resume checkpoint /home/mannicui/SAFE/results/SAFE/20251211_220758/checkpoint-best.pth
With optim & sched!
Eval only mode
/data/mannicui/miniconda3/envs/safe/lib/python3.9/site-packages/pytorch_wavelets/dtcwt/coeffs.py:7: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream
/data/mannicui/miniconda3/envs/safe/lib/python3.9/site-packages/pytorch_wavelets/dtcwt/coeffs.py:7: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream
/data/mannicui/miniconda3/envs/safe/lib/python3.9/site-packages/pytorch_wavelets/dtcwt/coeffs.py:7: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream
/data/mannicui/miniconda3/envs/safe/lib/python3.9/site-packages/pytorch_wavelets/dtcwt/coeffs.py:7: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream
Test:  [0/1]  eta: 0:00:03  loss: 0.5825 (0.5825)  acc1: 0.6875 (0.6875)  time: 3.4541
Test: Total time: 0:00:03 (3.4975 s / it)
* Acc@1 63.75% loss 0.6325
Accuracy of the network on 320 test images: 63.75%
test dataset is facebook acc: 63.75%, ap: 74.32%
***********************************
Test:  [0/2]  eta: 0:00:38  loss: 0.4669 (0.4669)  acc1: 0.7891 (0.7891)  time: 19.2071
Test:  [1/2]  eta: 0:00:09  loss: 0.4669 (0.5194)  acc1: 0.7059 (0.7627)  time: 9.6380
Test: Total time: 0:00:19 (9.6610 s / it)
* Acc@1 78.60% loss 0.5203
Accuracy of the network on 1500 test images: 78.60%
test dataset is reddit acc: 78.60%, ap: 86.48%
***********************************
Warning: Enabling distributed evaluation with an eval dataset not divisible by process number. This will slightly alter validation results as extra duplicate entries are added to achieve equal num of samples per-process.
Test:  [0/1]  eta: 0:00:04  loss: 0.7517 (0.7517)  acc1: 0.5189 (0.5189)  time: 4.1744
Test: Total time: 0:00:04 (4.2285 s / it)
* Acc@1 54.72% loss 0.7441
Accuracy of the network on 421 test images: 54.72%
test dataset is twitter acc: 54.72%, ap: 83.49%
***********************************